
```{r message=FALSE, warning=FALSE}
if(!require(dplyr)) install.packages("dplyr", repos="http://R-Forge.R-project.org", dependencies = TRUE)
library(dplyr)

if(!require(ggplot2)) install.packages("ggplot2", repos="http://R-Forge.R-project.org", dependencies = TRUE)
library(ggplot2)
```

```{r message=FALSE, warning=FALSE}
stats_regular_season = read.csv("bases_de_dados/stats_regular_season.csv")
stats_playoffs = read.csv("bases_de_dados/stats_playoffs.csv")
```

```{r fig.align='center', fig.width=15, fig.height=5,message=FALSE, warning=FALSE}
stats_regular_season <- mutate(stats_regular_season, PPG = round((PTS / GP), 1))
stats_playoffs <- mutate(stats_playoffs, PPG = round((PTS / GP), 1))

paleta_times <- c("red", "darkred", "gold", "darkorange", "steelblue")
grafico_pontos_idade_rs <- ggplot(data = stats_regular_season, aes(x = AGE, y = PPG, color = TEAM)) + geom_point(size = 3) + facet_wrap(~PLAYER, ncol = 3) + theme_linedraw() + xlim(18, 40) + ylim(0, 40) + scale_color_manual(values = paleta_times) + labs(title = "Média de Pts Por Jogo (RS)",x = "Idade Dos Jogadores", y = "Média de Pontos Por Partida", colour = "Equipe") + geom_hline(yintercept=30, linetype="dashed", color = "black", size = 1) + theme(plot.title = element_text(hjust = 0.5, size = 15))

grafico_pontos_idade_po <- ggplot(data = stats_playoffs, aes(x = AGE, y = PPG, color = TEAM)) + geom_point(size = 3) + facet_wrap(~PLAYER, ncol = 3) + theme_linedraw() + xlim(18, 40) + ylim(0, 40) + scale_color_manual(values = paleta_times) + labs(title = "Média de Pts Por Jogo (PO)",x = "Idade Dos Jogadores", y = "Média de Pontos Por Partida", colour = "Equipe") + geom_hline(yintercept=30, linetype="dashed", color = "black", size = 1) + theme(plot.title = element_text(hjust = 0.5, size = 15))

ggsave("imagens/graf_1.png", plot = grafico_pontos_idade_rs, dpi = 150)
ggsave("imagens/graf_2.png", plot = grafico_pontos_idade_po, dpi = 150)
```

```{r fig.align='center', fig.width=15, fig.height=5,message=FALSE, warning=FALSE}
stats_regular_season <- mutate(stats_regular_season, APG = round((AST/GP), 2))
stats_playoffs <- mutate(stats_playoffs, APG = round((AST/GP), 2))

graf_3 <- paleta_players <- c("gold", "darkred", "red")
grafico_assist_idade_rs <- ggplot(stats_regular_season, aes(x = AGE, y = APG, color = PLAYER)) + geom_line(size = 1, alpha = 0.6) + theme_minimal() + xlim(18, 40) + ylim(0, 12) + scale_color_manual(values = paleta_players) + labs(title = "Média de Assitências Por Jogo (RS)",x = "Idade Dos Jogadores", y = "Média de Assistências Por Partida", colour = "Jogador") + geom_hline(yintercept=7, linetype="dashed", color = "black", size = 1) + theme(plot.title = element_text(hjust = 0.5, size = 15))

grafico_assist_idade_po <- ggplot(stats_playoffs, aes(x = AGE, y = APG, color = PLAYER)) + geom_line(size = 1, alpha = 0.6) + theme_minimal() + xlim(18, 40) + ylim(0, 12) + scale_color_manual(values = paleta_players) + labs(title = "Média de Assitências Por Jogo (PO)",x = "Idade Dos Jogadores", y = "Média de Assistências Por Partida", colour = "Jogador") + geom_hline(yintercept=7, linetype="dashed", color = "black", size = 1) + theme(plot.title = element_text(hjust = 0.5, size = 15))

ggsave("imagens/graf_3.png", plot = grafico_assist_idade_rs, dpi = 150)
ggsave("imagens/graf_4.png", plot = grafico_assist_idade_po, dpi = 150)
```

```{r fig.align='center', fig.width=15, fig.height=5,message=FALSE, warning=FALSE}
stats_regular_season <- mutate(stats_regular_season, REP = round((REB/GP), 2))
stats_playoffs <- mutate(stats_playoffs,REP = round((REB/GP), 2))

graf_3 <- paleta_players <- c("gold", "darkred", "red")
grafico_reb_idade_rs <- ggplot(stats_regular_season, aes(x = AGE, y = REP, color = PLAYER)) + geom_line(size = 1, alpha = 0.6) + theme_minimal() + xlim(18, 40) + ylim(0, 12) + scale_color_manual(values = paleta_players) + labs(title = "Média de Rebotes Por Jogo (RS)",x = "Idade Dos Jogadores", y = "Média de Rebotes Por Partida", colour = "Jogador") + geom_hline(yintercept=7, linetype="dashed", color = "black", size = 1) + theme(plot.title = element_text(hjust = 0.5, size = 15))

grafico_reb_idade_po <- ggplot(stats_playoffs, aes(x = AGE, y = REP, color = PLAYER)) + geom_line(size = 1, alpha = 0.6) + theme_minimal() + xlim(18, 40) + ylim(0, 12) + scale_color_manual(values = paleta_players) + labs(title = "Média de Rebotes Por Jogo (PO)",x = "Idade Dos Jogadores", y = "Média de Rebotes Por Partida", colour = "Jogador") + geom_hline(yintercept=7, linetype="dashed", color = "black", size = 1) + theme(plot.title = element_text(hjust = 0.5, size = 15))

ggsave("imagens/graf_5.png", plot = grafico_reb_idade_rs, dpi = 150)
ggsave("imagens/graf_6.png", plot = grafico_reb_idade_po, dpi = 150)
```





